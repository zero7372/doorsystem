# 保祥門禁分析器

一個用於分析門禁系統日誌、統計員工出勤情況的工具，支援CSV日誌檔案匯入、資料分析和Excel匯出功能。

## 功能特點

- **CSV日誌匯入**：支援匯入門禁系統產生的CSV格式日誌文件
- **出勤資料分析**：自動分析員工的通勤時間，辨識遲到、早退、外出等狀況
- **員工篩選**：支援依員工姓名篩選記錄，快速查看特定員工的出勤狀況
- **資料視覺化**：透過表格形式清晰展示分析結果，支援狀態顏色區分和週末高亮
- **Excel匯出**：可將分析結果匯出為Excel文件，包含統計資料和每位員工的單獨工作表

## 技術堆疊

- Python 3.7+
- pandas - 資料處理
- xlsxwriter - Excel檔案生成
- flet - GUI介面開發
- PyInstaller - 打包成可執行檔

## 使用方法

### 直接執行可執行文件

1. 從`build/門禁日誌分析器`目錄中找到打包好的可執行檔
2. 雙擊運行程序
3. 點選"選擇門禁日誌檔案"按鈕，選擇門禁系統產生的CSV格式日誌文件
4. 系統自動分析資料並在表格中顯示結果
5. 可透過下拉式選單篩選特定員工的記錄
6. 點選"匯出Excel檔案"按鈕可將分析結果匯出為Excel文件

### 從原始碼運行

1. 確保已安裝Python 3.7或更高版本
2. 安裝所需依賴：
 ```
 pip install pandas xlsxwriter flet
 ```
3. 運行主程式：
 ```
 python access_log_analyzer.py
 ```

## 文件說明

- `access_log_analyzer.py`：主程式文件，包含UI介面和資料處理邏輯
- `excel_exporter.py`：Excel匯出模組，負責產生Excel報表
- `門禁日誌分析器.spec`：PyInstaller打包設定檔
- `build/`：包含打包後的可執行文件

## 資料格式要求

門禁日誌CSV檔案需包含以下：
- 記錄時間：記錄的時間戳
- 編號：員工編號
- 姓名：員工姓名

系統支援多種日期時間格式，會自動嘗試解析。

## 注意事項

1. 確保CSV檔案編碼正確，程式會自動嘗試多種編碼方式讀取
2. 匯出的Excel文件包含多個工作表：全部記錄、統計資訊以及每位員工的單獨工作表
3. 在Excel中，週末行以黃色背景高亮顯示，特殊狀態（遲到、早退、外出）以紅色文字顯示
4. 如果遇到無法解析的記錄，程式會跳過並繼續處理其他有效記錄

## 更新日誌

- 初始版本：基礎功能實現，包括日誌分析和Excel匯出